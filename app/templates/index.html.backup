<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Analyzer Pro</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="/static/css/style.css" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <nav class="navbar navbar-dark bg-primary fixed-top">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">
                <i class="bi bi-mic-fill"></i> Meeting Analyzer Pro
            </span>
            <span class="text-white">Made by Team 3</span>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid" style="margin-top: 70px;">
        <div class="row">
            <!-- Left Sidebar: Recording History (Compact) -->
            <div class="col-md-2 border-end sidebar-compact" style="height: calc(100vh - 70px); overflow-y: auto; background: #f8f9fa;">
                <div class="p-2">
                    <!-- Category Tabs (Compact) -->
                    <div class="mb-2">
                        <div class="nav flex-column nav-pills">
                            <a href="#" class="nav-link active compact-nav-link" data-category="recording" title="Ghi √¢m" onclick="switchTab('recording'); return false;">
                                <i class="bi bi-mic-fill"></i>
                                <span class="nav-text">Ghi √¢m</span>
                            </a>
                            <a href="#" class="nav-link compact-nav-link" data-category="upload" title="T·∫£i l√™n & Chuy·ªÉn vƒÉn b·∫£n" onclick="switchTab('upload'); return false;">
                                <i class="bi bi-cloud-upload"></i>
                                <span class="nav-text">T·∫£i l√™n</span>
                            </a>
                            <a href="#" class="nav-link compact-nav-link" data-category="export" title="Xu·∫•t file" onclick="switchTab('export'); return false;">
                                <i class="bi bi-download"></i>
                                <span class="nav-text">Xu·∫•t file</span>
                            </a>
                            <a href="#" class="nav-link compact-nav-link" data-category="smart-search" title="T√¨m ki·∫øm th√¥ng minh" onclick="switchTab('smart-search'); return false;">
                                <i class="bi bi-search"></i>
                                <span class="nav-text">AI Search</span>
                            </a>
                        </div>
                    </div>
                    
                    <hr class="my-2">
                    
                    <!-- Recording List (for recording category) -->
                    <div id="recordingList">
                        <!-- Will be populated by JS -->
                        <div class="text-center text-muted py-5">
                            <div class="spinner-border spinner-border-sm" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <p class="mt-2 small">ƒêang t·∫£i...</p>
                        </div>
                    </div>
                    
                    <!-- Analysis History List (for upload category) -->
                    <div id="analysisHistoryList" style="display: none;">
                        <!-- Will be populated by JS -->
                        <div class="text-center text-muted py-5">
                            <div class="spinner-border spinner-border-sm" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <p class="mt-2 small">ƒêang t·∫£i...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Area -->
            <div class="col-md-10">
                <!-- Initial View: Big Record Button -->
                <div id="initialView" class="p-4">
                    <div class="text-center" style="min-height: 400px; display: flex; align-items: center; justify-content: center;">
                        <div>
                            <button class="record-button" onclick="showRecordingPopup()">
                                <i class="bi bi-mic-fill"></i>
                                <div class="mt-3">Ghi √¢m ngay l·∫≠p t·ª©c</div>
                            </button>
                            <p class="text-muted mt-4">Nh·∫•n ƒë·ªÉ b·∫Øt ƒë·∫ßu ghi √¢m</p>
                        </div>
                    </div>
                </div>

                <!-- Recording View: Full Screen -->
                <div id="recordingView" class="p-4" style="display: none;">
                    <!-- Header -->
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div>
                            <h5 class="mb-1" id="recordingViewTitle">Ghi √¢m 6/12/2025</h5>
                            <small class="text-muted">
                                <span id="recordingViewLang">Ti·∫øng Vi·ªát</span> ‚Ä¢ 
                                <span id="recordingViewTimer">00:00</span>
                            </small>
                        </div>
                        <div>
                            <button class="btn btn-outline-secondary btn-sm me-2" onclick="toggleTranslation()">
                                <i class="bi bi-translate"></i> D·ªãch sang: <span id="translateLangDisplay">Ti·∫øng Anh</span>
                            </button>
                            <button class="btn btn-danger" onclick="stopRecording()">
                                <i class="bi bi-stop-fill"></i> D·ª´ng ghi √¢m
                            </button>
                        </div>
                    </div>

                    <!-- Recording Indicator -->
                    <div class="card mb-3 border-danger">
                        <div class="card-body py-2">
                            <div class="d-flex align-items-center">
                                <div class="recording-pulse me-3"></div>
                                <span class="text-danger fw-bold">ƒêang ghi √¢m...</span>
                                <span class="ms-auto text-muted">N√≥i r√µ r√†ng v√† ·ªü t·ªëc ƒë·ªô v·ª´a ph·∫£i, v√† tr√°nh nhi·ªÖu ng∆∞·ªùi n√≥i c√πng l√∫c</span>
                            </div>
                        </div>
                    </div>

                    <!-- Transcript Area -->
                    <div class="card">
                        <div class="card-body" style="min-height: 500px; max-height: 600px; overflow-y: auto;">
                            <div id="transcriptContent" style="white-space: pre-wrap; font-size: 15px; line-height: 1.8;">
                                <div class="text-center text-muted py-5">
                                    <i class="bi bi-mic" style="font-size: 3rem;"></i>
                                    <p class="mt-3">Transcript s·∫Ω xu·∫•t hi·ªán ·ªü ƒë√¢y khi b·∫°n n√≥i...</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Audio Waveform (optional) -->
                    <div class="mt-3">
                        <div class="d-flex align-items-center">
                            <i class="bi bi-soundwave me-2"></i>
                            <div class="flex-grow-1">
                                <div class="progress" style="height: 4px;">
                                    <div class="progress-bar bg-primary progress-bar-striped progress-bar-animated" 
                                         role="progressbar" style="width: 100%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Transcript Result View (after recording) -->
                <div id="resultView" class="p-4" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <div>
                            <h5 class="mb-1" id="resultViewTitle">Ghi √¢m 6/12/2025</h5>
                            <small class="text-muted">Ho√†n th√†nh ‚Ä¢ <span id="resultViewDuration">2:30</span></small>
                        </div>
                        <div>
                            <button class="btn btn-outline-primary btn-sm me-2" onclick="showInitialView()">
                                <i class="bi bi-arrow-left"></i> Ghi √¢m m·ªõi
                            </button>
                            <button class="btn btn-primary btn-sm" onclick="saveCurrentRecording()">
                                <i class="bi bi-save"></i> L∆∞u
                            </button>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-body">
                            <h6 class="mb-3"><i class="bi bi-file-text"></i> Transcript</h6>
                            <div id="finalTranscript" style="white-space: pre-wrap; font-size: 15px; line-height: 1.8;">
                                <!-- Final transcript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Upload View: Upload & Transcribe -->
                <div id="uploadView" class="p-4" style="display: none;">
                    <div class="row">
                        <!-- Left: Upload Controls -->
                        <div class="col-md-4">
                            <h5 class="mb-4">üìÅ T·∫£i File L√™n</h5>
                            
                            <!-- File Type Selector -->
                            <div class="mb-3">
                                <label class="form-label">Lo·∫°i file</label>
                                <div class="btn-group w-100" role="group">
                                    <input type="radio" class="btn-check" name="fileType" id="fileTypeAudio" value="audio" checked>
                                    <label class="btn btn-outline-primary" for="fileTypeAudio">
                                        <i class="bi bi-music-note-beamed"></i> Audio
                                    </label>
                                    
                                    <input type="radio" class="btn-check" name="fileType" id="fileTypeText" value="text">
                                    <label class="btn btn-outline-primary" for="fileTypeText">
                                        <i class="bi bi-file-text"></i> Text
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Audio File Upload -->
                            <div id="audioFileSection" class="mb-3">
                                <label class="form-label">Ch·ªçn file audio</label>
                                <input type="file" class="form-control" id="audioFileInput" 
                                       accept=".wav,.mp3,.m4a,.webm,.ogg">
                                <small class="text-muted">WAV, MP3, M4A, WebM, OGG</small>
                            </div>
                            
                            <!-- Text File Upload -->
                            <div id="textFileSection" class="mb-3" style="display: none;">
                                <label class="form-label">Ch·ªçn file text</label>
                                <input type="file" class="form-control" id="textFileInput" 
                                       accept=".txt,.docx">
                                <small class="text-muted">TXT, DOCX</small>
                            </div>
                            
                            <!-- Audio Options -->
                            <div id="audioOptions">
                                <div class="mb-3">
                                    <label class="form-label">Ng√¥n ng·ªØ audio</label>
                                    <select class="form-select" id="transcribeLang">
                                        <option value="vi">Ti·∫øng Vi·ªát</option>
                                        <option value="en">English</option>
                                        <option value="ja">Êó•Êú¨Ë™û</option>
                                        <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                                        <option value="zh">‰∏≠Êñá</option>
                                    </select>
                                </div>
                                
                                <div class="mb-3">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="enableDiarization">
                                        <label class="form-check-label" for="enableDiarization">
                                            üé§ Ph√¢n bi·ªát ng∆∞·ªùi n√≥i
                                        </label>
                                    </div>
                                    <small class="text-muted">G√°n nh√£n Guest-1, Guest-2,... cho t·ª´ng ng∆∞·ªùi n√≥i</small>
                                </div>
                            </div>
                            
                            <hr>
                            
                            <h6 class="mb-3">‚öôÔ∏è C√†i ƒê·∫∑t Ph√¢n T√≠ch</h6>
                            
                            <div class="mb-3">
                                <label class="form-label">Lo·∫°i cu·ªôc h·ªçp</label>
                                <select class="form-select" id="uploadMeetingType">
                                    <option value="meeting">üìã Meeting - Cu·ªôc h·ªçp th∆∞·ªùng</option>
                                    <option value="workshop">üéì Workshop - ƒê√†o t·∫°o/H·ªôi th·∫£o</option>
                                    <option value="brainstorming">üí° Brainstorming - ƒê·ªông n√£o</option>
                                </select>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">Ng√¥n ng·ªØ output</label>
                                <select class="form-select" id="uploadOutputLang">
                                    <option value="vi">Ti·∫øng Vi·ªát</option>
                                    <option value="en">English</option>
                                    <option value="ja">Êó•Êú¨Ë™û</option>
                                    <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                                    <option value="zh">‰∏≠Êñá</option>
                                </select>
                            </div>
                            
                            <button class="btn btn-primary w-100" onclick="processUpload()">
                                <i class="bi bi-rocket-takeoff"></i> X·ª≠ L√Ω & Ph√¢n T√≠ch
                            </button>
                            
                            <div id="uploadStatus" class="mt-3" style="display: none;">
                                <!-- Status messages -->
                            </div>
                        </div>
                        
                        <!-- Right: Results -->
                        <div class="col-md-8">
                            <h5 class="mb-4">üìä K·∫øt Qu·∫£</h5>
                            
                            <!-- Tabs for Results -->
                            <ul class="nav nav-tabs" id="uploadResultTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="transcript-tab" data-bs-toggle="tab" 
                                            data-bs-target="#transcript-pane" type="button">
                                        üìù Transcript
                                    </button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="analysis-tab" data-bs-toggle="tab" 
                                            data-bs-target="#analysis-pane" type="button">
                                        üìä Ph√¢n T√≠ch
                                    </button>
                                </li>
                            </ul>
                            
                            <div class="tab-content border border-top-0 p-3" id="uploadResultTabContent">
                                <!-- Transcript Tab -->
                                <div class="tab-pane fade show active" id="transcript-pane">
                                    <div id="uploadTranscript" class="transcript-box" style="min-height: 400px; white-space: pre-wrap;">
                                        <div class="text-center text-muted py-5">
                                            <i class="bi bi-file-earmark-text" style="font-size: 3rem;"></i>
                                            <p class="mt-3">Transcript s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y sau khi x·ª≠ l√Ω...</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Analysis Tab -->
                                <div class="tab-pane fade" id="analysis-pane">
                                    <!-- Sub-tabs for Analysis -->
                                    <ul class="nav nav-pills mb-3" id="analysisTabs" role="tablist">
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link active" data-bs-toggle="pill" 
                                                    data-bs-target="#summary-pane">T√≥m t·∫Øt</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" data-bs-toggle="pill" 
                                                    data-bs-target="#topics-pane">Ch·ªß ƒë·ªÅ</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" data-bs-toggle="pill" 
                                                    data-bs-target="#actions-pane">Actions</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" data-bs-toggle="pill" 
                                                    data-bs-target="#decisions-pane">Quy·∫øt ƒë·ªãnh</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" data-bs-toggle="pill" 
                                                    data-bs-target="#participants-pane">Ng∆∞·ªùi tham gia</button>
                                        </li>
                                    </ul>
                                    
                                    <div class="tab-content">
                                        <div class="tab-pane fade show active" id="summary-pane">
                                            <div id="uploadSummary" class="analysis-content">
                                                <em class="text-muted">Ch∆∞a c√≥ d·ªØ li·ªáu</em>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="topics-pane">
                                            <div id="uploadTopics" class="analysis-content">
                                                <em class="text-muted">Ch∆∞a c√≥ d·ªØ li·ªáu</em>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="actions-pane">
                                            <div id="uploadActions" class="analysis-content">
                                                <em class="text-muted">Ch∆∞a c√≥ d·ªØ li·ªáu</em>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="decisions-pane">
                                            <div id="uploadDecisions" class="analysis-content">
                                                <em class="text-muted">Ch∆∞a c√≥ d·ªØ li·ªáu</em>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade" id="participants-pane">
                                            <div id="uploadParticipants" class="analysis-content">
                                                <em class="text-muted">Ch∆∞a c√≥ d·ªØ li·ªáu</em>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Recording Setup Modal -->
    <div class="modal fade" id="recordingSetupModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ghi √¢m ngay l·∫≠p t·ª©c</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="recordingSetupForm">
                        <div class="mb-3">
                            <label class="form-label">Ti√™u ƒë·ªÅ</label>
                            <input type="text" class="form-control" id="recordingTitle" 
                                   value="Ghi √¢m 6/12/2025" required>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Ng√¥n ng·ªØ h·ª£p</label>
                            <select class="form-select" id="recordingLanguage">
                                <option value="vi">Ti·∫øng Vi·ªát</option>
                                <option value="en">English</option>
                                <option value="ja">Êó•Êú¨Ë™û</option>
                                <option value="ko">ÌïúÍµ≠Ïñ¥</option>
                                <option value="zh">‰∏≠Êñá</option>
                            </select>
                        </div>
                        
                        <div class="mb-3">
                            <label class="form-label">Ngu·ªìn √¢m thanh</label>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="audioSource" 
                                       id="sourceMicrophone" value="microphone" checked>
                                <label class="form-check-label" for="sourceMicrophone">
                                    <i class="bi bi-mic"></i> Microphone
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="radio" name="audioSource" 
                                       id="sourceScreen" value="screen">
                                <label class="form-check-label" for="sourceScreen">
                                    <i class="bi bi-display"></i> Tab/M√†n h√¨nh (Screen Audio)
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="realtimeMode" checked>
                                <label class="form-check-label" for="realtimeMode">
                                    T·ª± ƒë·ªông d·ªãch (B·∫°n c√≥ mu·ªën b·∫£n phi√™n √¢m ƒë∆∞·ª£c d·ªãch kh√¥ng?)
                                </label>
                            </div>
                        </div>
                        
                        <div class="mb-3" id="translateOptions" style="display: none;">
                            <label class="form-label">D·ªãch sang</label>
                            <select class="form-select" id="translateLanguage">
                                <option value="vi">Ti·∫øng Vi·ªát</option>
                                <option value="en">Ti·∫øng Anh</option>
                                <option value="ja">Ti·∫øng Nh·∫≠t</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Quay l·∫°i</button>
                    <button type="button" class="btn btn-primary" onclick="startRecording()">Ti·∫øp t·ª•c</button>
                </div>

                <!-- Export View: Export Files -->
                <div id="exportView" class="p-4" style="display: none;">
                    <h5 class="mb-4">üì• Xu·∫•t File K·∫øt Qu·∫£</h5>
                    
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i>
                        <strong>L∆∞u √Ω:</strong> C·∫ßn ph√¢n t√≠ch transcript ·ªü tab "T·∫£i l√™n" tr∆∞·ªõc khi xu·∫•t file.
                    </div>
                    
                    <div class="row g-4">
                        <!-- TXT Export -->
                        <div class="col-md-6">
                            <div class="export-card">
                                <div class="export-icon">
                                    <i class="bi bi-file-text"></i>
                                </div>
                                <h5 class="mt-3">Xu·∫•t TXT</h5>
                                <p class="text-muted small">
                                    ƒê·ªãnh d·∫°ng vƒÉn b·∫£n ƒë∆°n gi·∫£n, d·ªÖ ƒë·ªçc v√† chia s·∫ª
                                </p>
                                
                                <ul class="export-features">
                                    <li><i class="bi bi-check-circle-fill text-success"></i> ƒê∆°n gi·∫£n, d·ªÖ ƒë·ªçc</li>
                                    <li><i class="bi bi-check-circle-fill text-success"></i> M·ªü ƒë∆∞·ª£c tr√™n m·ªçi thi·∫øt b·ªã</li>
                                    <li><i class="bi bi-check-circle-fill text-success"></i> Dung l∆∞·ª£ng nh·ªè</li>
                                    <li><i class="bi bi-check-circle-fill text-success"></i> Ph√π h·ª£p g·ª≠i email nhanh</li>
                                </ul>
                                
                                <button class="btn btn-primary w-100 mt-3" onclick="exportToTXT()">
                                    <i class="bi bi-download"></i> Xu·∫•t TXT
                                </button>
                            </div>
                        </div>
                        
                        <!-- DOCX Export -->
                        <div class="col-md-6">
                            <div class="export-card">
                                <div class="export-icon" style="background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);">
                                    <i class="bi bi-file-earmark-word"></i>
                                </div>
                                <h5 class="mt-3">Xu·∫•t DOCX (Word)</h5>
                                <p class="text-muted small">
                                    ƒê·ªãnh d·∫°ng chuy√™n nghi·ªáp v·ªõi styling ƒë·∫πp
                                </p>
                                
                                <ul class="export-features">
                                    <li><i class="bi bi-check-circle-fill text-success"></i> Format chuy√™n nghi·ªáp</li>
                                    <li><i class="bi bi-check-circle-fill text-success"></i> Ch·ªânh s·ª≠a trong Word</li>
                                    <li><i class="bi bi-check-circle-fill text-success"></i> Ph√π h·ª£p l√†m b√°o c√°o</li>
                                    <li><i class="bi bi-check-circle-fill text-success"></i> C√≥ ƒë·ªãnh d·∫°ng ƒë·∫πp</li>
                                </ul>
                                
                                <button class="btn btn-primary w-100 mt-3" onclick="exportToDOCX()">
                                    <i class="bi bi-download"></i> Xu·∫•t DOCX
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Export Status -->
                    <div id="exportStatus" class="mt-4" style="display: none;">
                        <!-- Status messages -->
                    </div>
                    
                    <!-- What's Included -->
                    <div class="card mt-4">
                        <div class="card-body">
                            <h6 class="card-title">üìå File s·∫Ω bao g·ªìm:</h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <ul class="list-unstyled">
                                        <li><i class="bi bi-check2 text-primary"></i> T√≥m t·∫Øt cu·ªôc h·ªçp</li>
                                        <li><i class="bi bi-check2 text-primary"></i> Ch·ªß ƒë·ªÅ ch√≠nh</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul class="list-unstyled">
                                        <li><i class="bi bi-check2 text-primary"></i> Action items (c√¥ng vi·ªác c·∫ßn l√†m)</li>
                                        <li><i class="bi bi-check2 text-primary"></i> Quy·∫øt ƒë·ªãnh quan tr·ªçng</li>
                                    </ul>
                                </div>
                            </div>
                            <p class="text-muted small mb-0 mt-2">
                                <i class="bi bi-folder"></i> T√™n file: <code>meeting_analysis_YYYYMMDD_HHMMSS.txt/docx</code>
                            </p>
                        </div>
                    </div>
                    
                    <!-- Recent Exports (Optional) -->
                    <div class="card mt-4">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">üìÇ File ƒë√£ xu·∫•t g·∫ßn ƒë√¢y</h6>
                        </div>
                        <div class="card-body">
                            <div id="recentExports" class="text-muted small">
                                <em>Ch∆∞a c√≥ file n√†o ƒë∆∞·ª£c xu·∫•t</em>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Smart Search View: AI-Powered Semantic Search -->
                <!-- Smart Search View: AI-Powered Semantic Search & Chat -->
                <div id="smartSearchView" class="p-4" style="display: none; height: calc(100vh - 70px);">
                    <div class="d-flex flex-column h-100">
                        <!-- Header -->
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="mb-0 text-primary">
                                <i class="bi bi-stars"></i> AI Smart Search & Chat
                            </h5>
                            <div>
                                <button class="btn btn-sm btn-outline-secondary" onclick="clearSmartChat()">
                                    <i class="bi bi-trash"></i> X√≥a l·ªãch s·ª≠
                                </button>
                            </div>
                        </div>

                        <!-- Chat Container -->
                        <div id="smartChatContainer" class="flex-grow-1 border rounded bg-light mb-3 p-3" style="overflow-y: auto; position: relative;">
                            <!-- Initial Welcome Message -->
                            <div id="smartChatWelcome" class="text-center text-muted position-absolute top-50 start-50 translate-middle w-100">
                                <i class="bi bi-robot" style="font-size: 4rem; color: #cbd5e1;"></i>
                                <h4 class="mt-3 text-dark">AI Assistant</h4>
                                <p>T√¥i ƒë√£ h·ªçc to√†n b·ªô l·ªãch s·ª≠ cu·ªôc h·ªçp c·ªßa b·∫°n.<br>H√£y h·ªèi t√¥i b·∫•t c·ª© ƒëi·ªÅu g√¨!</p>
                                
                                <!-- Quick Questions -->
                                <div class="d-flex justify-content-center gap-2 mt-4 flex-wrap px-4">
                                    <button class="btn btn-outline-primary rounded-pill px-3" onclick="sendSmartChat('T√≥m t·∫Øt c√°c cu·ªôc h·ªçp g·∫ßn ƒë√¢y')">
                                        üìù T√≥m t·∫Øt g·∫ßn ƒë√¢y
                                    </button>
                                    <button class="btn btn-outline-primary rounded-pill px-3" onclick="sendSmartChat('C√≥ quy·∫øt ƒë·ªãnh quan tr·ªçng n√†o kh√¥ng?')">
                                        üí° Quy·∫øt ƒë·ªãnh quan tr·ªçng
                                    </button>
                                    <button class="btn btn-outline-primary rounded-pill px-3" onclick="sendSmartChat('Li·ªát k√™ c√°c action items')">
                                        ‚úÖ Action items
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Messages Area -->
                            <div id="smartChatMessages" class="d-flex flex-column gap-3"></div>
                            
                            <!-- Typing Indicator -->
                            <div id="smartChatTyping" class="typing-indicator mt-2" style="display: none;">
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>
                        </div>

                        <!-- Input Area -->
                        <div class="card border-0 shadow-sm">
                            <div class="card-body p-2">
                                <div class="input-group input-group-lg">
                                    <input type="text" class="form-control border-0" id="smartChatInput" 
                                           placeholder="Nh·∫≠p c√¢u h·ªèi c·ªßa b·∫°n v·ªÅ c√°c cu·ªôc h·ªçp..." 
                                           onkeypress="handleSmartChatKeyPress(event)">
                                    <button class="btn btn-primary rounded-end" onclick="sendSmartChatMessage()">
                                        <i class="bi bi-send-fill"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Popup -->
    <div id="loadingPopup" class="loading-popup" style="display: none;">
        <div class="loading-popup-content">
            <div class="loading-spinner">
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
            </div>
            <h5 class="mt-4 mb-2" id="loadingTitle">ƒêang x·ª≠ l√Ω...</h5>
            <p class="text-muted" id="loadingMessage">Vui l√≤ng ƒë·ª£i trong gi√¢y l√°t</p>
            <div class="progress mt-3" style="height: 4px; width: 200px;">
                <div class="progress-bar progress-bar-striped progress-bar-animated" 
                     role="progressbar" style="width: 100%"></div>
            </div>
        </div>
    </div>

    <!-- AI Chat Widget -->
    <div id="aiChatWidget" class="ai-chat-widget">
        <!-- Chat Button (Floating) -->
        <button id="aiChatToggle" class="ai-chat-toggle" onclick="toggleAIChat()">
            <i class="bi bi-robot"></i>
            <span class="chat-badge" id="chatBadge" style="display: none;">1</span>
        </button>
        
        <!-- Chat Window -->
        <div id="aiChatWindow" class="ai-chat-window" style="display: none;">
            <!-- Header -->
            <div class="ai-chat-header">
                <div class="d-flex align-items-center">
                    <i class="bi bi-stars me-2"></i>
                    <span class="fw-bold">AI Assistant</span>
                </div>
                <button class="btn-close btn-close-white" onclick="toggleAIChat()"></button>
            </div>
            
            <!-- Quick Actions -->
            <div class="ai-chat-quick-actions">
                <div class="text-muted small mb-2">How can I help?</div>
                <button class="quick-action-btn" onclick="sendQuickQuestion('T√≥m t·∫Øt cu·ªôc h·ªçp n√†y')">
                    <i class="bi bi-file-text"></i> T√≥m t·∫Øt cu·ªôc h·ªçp
                </button>
                <button class="quick-action-btn" onclick="sendQuickQuestion('Ai tham gia cu·ªôc h·ªçp?')">
                    <i class="bi bi-people"></i> Ng∆∞·ªùi tham gia
                </button>
                <button class="quick-action-btn" onclick="sendQuickQuestion('Action items l√† g√¨?')">
                    <i class="bi bi-check-circle"></i> Action items
                </button>
                <button class="quick-action-btn" onclick="sendQuickQuestion('Quy·∫øt ƒë·ªãnh quan tr·ªçng n√†o ƒë∆∞·ª£c ƒë∆∞a ra?')">
                    <i class="bi bi-lightbulb"></i> Quy·∫øt ƒë·ªãnh quan tr·ªçng
                </button>
            </div>
            
            <!-- Chat Messages -->
            <div id="aiChatMessages" class="ai-chat-messages">
                <div class="ai-message">
                    <div class="message-avatar">
                        <i class="bi bi-robot"></i>
                    </div>
                    <div class="message-content">
                        <div class="message-text">
                            Xin ch√†o! T√¥i l√† AI Assistant. T√¥i c√≥ th·ªÉ gi√∫p b·∫°n ph√¢n t√≠ch cu·ªôc h·ªçp, tr·∫£ l·ªùi c√¢u h·ªèi v·ªÅ transcript, v√† nhi·ªÅu h∆°n n·ªØa. 
                            <br><br>
                            H√£y ch·ªçn m·ªôt c√¢u h·ªèi nhanh ·ªü tr√™n ho·∫∑c g√µ c√¢u h·ªèi c·ªßa b·∫°n!
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Input Area -->
            <div class="ai-chat-input">
                <input type="text" id="aiChatInputField" class="form-control" 
                       placeholder="Send a message..." 
                       onkeypress="handleChatKeyPress(event)">
                <button class="btn btn-primary" onclick="sendChatMessage()">
                    <i class="bi bi-send-fill"></i>
                </button>
            </div>
            
            <!-- Footer -->
            <div class="ai-chat-footer">
                <small class="text-muted">
                    <i class="bi bi-lightning-charge-fill"></i> Powered by Gemini AI
                </small>
            </div>
        </div>
    </div>

    <!-- Screen Share Confirmation Modal -->
    <div class="modal fade" id="screenShareModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Ghi √¢m ngay l·∫≠p t·ª©c</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-info">
                        <h6>T·∫°i sao ch√∫ng t√¥i c·∫ßn b·∫°n chia s·∫ª m√†n h√¨nh c·ªßa b·∫°n?</h6>
                        <p class="mb-0">N·∫øu b·∫°n ch·ªçn kh√¥ng chia s·∫ª m√†n h√¨nh, ·ª©ng d·ª•ng c√≥ th·ªÉ kh√¥ng thu ƒë∆∞·ª£c √¢m thanh t·ª´ c√°c ngu·ªìn b√™n ngo√†i nh∆∞ Teams ho·∫∑c Google Meet, v√† do ƒë√≥ c√≥ th·ªÉ kh√¥ng ho·∫°t ƒë·ªông nh∆∞ mong ƒë·ª£i</p>
                    </div>
                    
                    <h6>C√°ch thu √¢m:</h6>
                    <ol class="small">
                        <li>M·ªôt c·ª≠a s·ªï b·∫≠t l√™n s·∫Ω y√™u c·∫ßu b·∫°n ch·ªçn m√†n h√¨nh chia s·∫ª</li>
                        <li>Ch·ªçn tab "Th·∫ª tr√¨nh duy·ªát Chrome"</li>
                        <li>Ch·ªçn tab c√≥ audio ƒëang ph√°t</li>
                        <li><strong>B·∫¨T checkbox "Chia s·∫ª c·∫£ √¢m thanh tr√™n th·∫ª"</strong></li>
                        <li>Nh·∫•n "Chia s·∫ª"</li>
                    </ol>
                    
                    <div class="form-check form-switch">
                        <input class="form-check-input" type="checkbox" id="allowScreenShare" checked>
                        <label class="form-check-label" for="allowScreenShare">
                            Cho ph√©p ghi √¢m m√†n h√¨nh
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Quay l·∫°i</button>
                    <button type="button" class="btn btn-dark" onclick="confirmScreenShare()">X√°c nh·∫≠n</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Socket.IO Client -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <!-- Custom JS -->
    <script src="/static/js/app.js"></script>
</body>
</html>
